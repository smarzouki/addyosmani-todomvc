/*!
  * Fidel - A javascript controller
  * v1.2.2
  * https://github.com/jgallen23/fidel
  * copyright JGA 2011
  * MIT License
  */
  !function(h,b){"undefined"!=typeof module&&module.exports?module.exports=b():"function"==typeof define&&"object"==typeof define.amd?define(b):this[h]=b()}("Fidel",function(){var h=this,b={guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var c=16*Math.random()|0;return("x"===a?c:c&3|8).toString(16)}).toUpperCase()},extend:function(){throw Error("Fidel.extend is deprecated, please use Fidel.ViewController.extend");}},j=h.Fidel;b.noConflict=function(){h.Fidel=
  j;return this};var i=!1,k=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;b.Class=function(){};b.Class.extend=function(a){function c(a){if(!i){if(this.defaults)for(var c in this.defaults)if("object"!==typeof a||!a[c])this[c]=this.defaults[c];if("object"===typeof a)for(var d in a)this[d]=a[d];this.guid||(this.guid=b.guid());this._initialize&&this._initialize.apply(this,arguments);this.init&&this.init.apply(this,arguments)}}var d=this.prototype;i=!0;var e=new this;i=!1;for(var f in a)e[f]="function"==
  typeof a[f]&&"function"==typeof d[f]&&k.test(a[f])?function(a,c){return function(){var b=this._super;this._super=d[a];var e=c.apply(this,arguments);this._super=b;return e}}(f,a[f]):a[f];c.prototype=e;c.prototype.proxy=function(a){var c=this;return function(){if(a)return a.apply(c,arguments)}};c.constructor=c;c.extend=arguments.callee;return c};var g={};b.publish=function(a,c){for(var d=g[a],b=d?d.length:0;b--;)d[b].apply(this,c||[])};b.subscribe=function(a,c){g[a]||(g[a]=[]);g[a].push(c);return[a,
  c]};b.unsubscribe=function(a){for(var c=g[a[0]],a=a[1],b=c?c.length:0;b--;)c[b]===a&&c.splice(b,1)};b.Class.prototype.on=b.Class.prototype.bind=function(a,c){return b.subscribe(this.guid+"."+a,this.proxy(c))};b.Class.prototype.emit=b.Class.prototype.trigger=function(a,c){b.publish(this.guid+"."+a,c);b.publish(a,c)};b.Class.prototype.removeListener=b.Class.prototype.unbind=function(a){b.unsubscribe(a)};!function(){var a={};b.template=function d(b,f){var g=!/\W/.test(b)?a[b]=a[b]||d(b):new Function("obj",
  "var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+b.replace(/[\r\t\n]/g,"").split("{!").join("\t").replace(/((^|!})[^\t]*)'/g,"$1\r").replace(/\t=(.*?)!}/g,"',$1,'").split("\t").join("');").split("!}").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return f?g(f):g}}();var l=/^(\w+)\s*(.*)$/,m=b.Class.extend({_initialize:function(){if(!this.el)throw"el is required";this._subscribeHandles={};this.events&&this.delegateEvents();this.elements&&this.refreshElements();
  this.templates&&this.loadTemplates();this.actionEvent||(this.actionEvent="click");this.subscribe&&this.bindSubscriptions();this.delegateActions();this.getDataElements()},template:b.template,delegateEvents:function(){for(var a in this.events){var c=this.events[a],b=a.match(l),e=b[1],b=b[2],c=this.proxy(this[c]);""===b?this.el.bind(e,c):this.el.delegate(b,e,c)}},delegateActions:function(){var a=this;this.el.delegate("[data-action]",this.actionEvent,function(b){var d=$(this),e=d.attr("data-action");
  a[e]&&a[e].call(a,d,b)})},refreshElements:function(){for(var a in this.elements)this[a]=this.find(this.elements[a])},getDataElements:function(){for(var a=this.find("[data-element]"),b=0,d=a.length;b<d;b++){var e=a[b].getAttribute("data-element");if(!this[e]){var f=this.find('[data-element="'+e+'"]');this[e]=f}}},bindSubscriptions:function(){for(var a in this.subscribe)this._subscribeHandles[a]=b.subscribe(a,this.proxy(this[this.subscribe[a]]))},loadTemplates:function(){for(var a in this.templates)this.templates[a]=
  $(this.templates[a]).html()},find:function(a){return $(a,this.el[0])},render:function(a,b,d){1==arguments.length&&(b=a,a=this.primaryTemplate);if(template=this.templates[a]){var e=this.template(template,b),d=d?$(d):this.el;d.html(e)}},destroy:function(){for(var a in this._subscribeHandles)b.unsubscribe(this._subscribeHandles[a]);this.el.undelegate("[data-action]",this.actionEvent);this.el=null}});b.ViewController=m;return b});